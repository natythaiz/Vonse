<!DOCTYPE html>
<html lang="pt-BR" layout:decorate="~{layout/layoutpadrao}" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finalizar Venda</title>
</head>

<body>
<main layout:fragment="conteudo" th:fragment="formulario" id="main" class="flex flex-col align-middle w-full m-10">

    <h2 class="text-xl font-semibold text-gray-400 md:text-3xl">Finalizar Venda</h2>

    <!-- Cliente -->
    <div class="mt-6">
        <h3 class="text-lg font-medium text-gray-700">Cliente</h3>
        <p th:text="${venda.cliente.nome}" class="text-gray-600"></p>
        <p th:text="'Contato: ' + ${venda.cliente.contato}" class="text-gray-600"></p>
    </div>

    <!-- Itens da Venda -->
    <div class="mt-8">
        <h3 class="text-lg font-medium text-gray-700">Itens da Venda</h3>
        <div class="overflow-x-auto mt-4">
            <table class="min-w-full divide-y divide-gray-200">
                <thead>
                    <tr>
                        <th class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Produto</th>
                        <th class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Quantidade</th>
                        <th class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Preço Unitário</th>
                        <th class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Subtotal</th>
                        <th class="px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase">Ação</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="item : ${venda.itensVendidos}" class="odd:bg-white even:bg-gray-100 hover:bg-gray-200">
                        <td th:text="${item.produto.nome}" class="px-6 py-4 whitespace-nowrap text-sm text-gray-800"></td>
                        <td th:text="${item.quantidade}" class="px-6 py-4 whitespace-nowrap text-sm text-gray-800"></td>
                        <td th:text="${#numbers.formatDecimal(item.precoUnitario, 1, 'POINT', 2, 'POINT')}" class="px-6 py-4 whitespace-nowrap text-sm text-gray-800"></td>
                        <td th:text="${#numbers.formatDecimal(item.subTotal, 1, 'POINT', 2, 'POINT')}" class="px-6 py-4 whitespace-nowrap text-sm text-gray-800"></td>
                        <td>
                            <a th:hx-get="@{/vendas/removeritem/{id}(id=${item.id})}" hx-target="#main" hx-swap="outerHTML"
                               class="text-red-600 hover:text-red-400">Remover</a>
                        </td>
                    </tr>
                    <tr th:if="${venda.itensVendidos.empty}">
                        <td colspan="5" class="px-6 py-4 text-center text-sm text-gray-500">Nenhum item adicionado à venda.</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Total -->
    <div class="mt-6 text-right">
        <h3 class="text-lg font-medium text-gray-700">Total da Venda:</h3>
        <p th:text="'R$ ' + ${#numbers.formatDecimal(venda.valorTotal, 1, 'POINT', 2, 'POINT')}" class="text-xl font-semibold text-gray-800"></p>
    </div>

    <!-- Botão Finalizar -->
    <div class="mt-8">
        <form th:hx-post="@{/vendas/finalizar}" hx-target="#main" hx-swap="outerHTML">
            <button type="submit" class="py-3 px-6 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-transparent bg-green-100 text-green-800 hover:bg-green-200 focus:outline-none focus:bg-green-200">
                Finalizar Venda
            </button>
        </form>
    </div>

</main>
</body>
</html>
